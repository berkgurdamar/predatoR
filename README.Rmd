---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "inst/extdata",
  out.width = "100%"
)
```

# <img src="https://github.com/berkgurdamar/predatoR/blob/main/inst/extdata/predator_logo.png?raw=true" align="left" height=150/> predatoR: Mutation Impact Prediction Based on Network Properties

<!-- badges: start -->
<!-- badges: end -->

<br />
<br />

# Overview

`predatoR` is a tool for impact prediction of a mutation on a protein structure by using network properties. 

# Installation

You can install the released version of predatoR from [CRAN](https://CRAN.R-project.org) with:

``` {r installation_guide1, eval=FALSE}
install.packages("predatoR")
```

or install via [devtools](https://www.r-project.org/nosvn/pandoc/devtools.html):

``` {r installation_guide2, eval=FALSE}
library(devtools)
install_github("berkgurdamar/predatoR")
```

# Usage

`predatoR` uses data.frame structures as an input. data.frame should consist of __'PDB_ID'__, __'Chain'__, __'Position'__, __'Orig_AA'__, __'Mut_AA'__ and __'Gene_Name'__ as an optional input:

```{r example_input, echo=FALSE}
test_data <- as.data.frame(rbind(c("2DN2", "B", 1, "VAL", "ALA", "HBB"),
                                 c("2DN2", "B", 6, "GLU", "ALA", "HBB")))
colnames(test_data) <- c("PDB_ID", "Chain", "Position", "Orig_AA", "Mut_AA", "Gene_Name")
knitr::kable(test_data, align = c("c", "c", "c", "c", "c", "c"))
```

Mutation impact prediction can be done via `predatoR()` function:

`predatoR()` function works on each PDB ID respectively. First, downloads the PDB file, creates distance matrix between every atom and turns PDB structure into a network model. Calculates __Eigen Centrality Z-Score, Shortest Path Z-score__ and __Betweenness Z-Score__ of input positions.  If __'Gene_Name'__ is not provided in the input, `predatoR()` gets the related gene names from __'Ensembl-BioMart'__ and if there are multiple genes annotated for the PDB ID, asks user to choose input __'Gene_Name'__, gets __GnomAD Synonymous Z-Score, Non-Synonymous Z-Score, PLoF Score__, and __Genic Intolerance Score__, gets __BLOSUM62 score__ of the mutation, finds the __KEGG Pathway Number__ which contains the input gene. Finally, make prediction based on an pre-computed __Adaboost__ model and classifies the mutation as __Disease Causing__ or __Silent__.


```{r usage, eval=FALSE}
library(predatoR)
pred_res <- predatoR(input_df)
```

`predatoR()` function returns a data.frame which contains additional two columns; __'Prediction'__ and __'Probability'__. __'Prediction'__ represents the result of the impact prediction and __'Probability'__ represents the probability that the mutation classified as __Disease Causing__ or __Silent__.

```{r example_output, echo=FALSE}
example_result <- as.data.frame(rbind(c("2DN2", "B", 1, "VAL", "ALA", "HBB", "Silent", "0.6205009"),
                                      c("2DN2", "B", 6, "GLU", "ALA", "HBB", "Silent", "0.6286857")))

colnames(example_result) <- c("PDB_ID", "Chain", "Position", "Orig_AA", "Mut_AA", "Gene_Name", "Prediction", "Probability")

knitr::kable(example_result, align = c("c", "c", "c", "c", "c", "c", "c", "c"))
```

